---
/**
 * MeetingCard - Clean, focused card for meeting listings
 * Shows only essential info: title, date, type, vote count, and preview
 */

interface Props {
  id: number;
  title: string;
  date: string;
  type: string;
  summary: string[];
  voteCount: number;
}

const { id, title, date, type, summary, voteCount } = Astro.props;

// Ensure base URL ends with /
const base = import.meta.env.BASE_URL.endsWith('/') ? import.meta.env.BASE_URL : import.meta.env.BASE_URL + '/';

// Format date for display - cleaner format
const formattedDate = date ? new Date(date).toLocaleDateString('en-US', {
  month: 'short',
  day: 'numeric',
  year: 'numeric'
}) : 'Date unknown';

// Get first summary bullet as preview, cleaned up
const previewText = summary.length > 0
  ? summary[0].replace(/^[-â€¢]\s*/, '').trim()
  : 'No summary available';
---

<a href={`${base}meetings/${id}`} class="card bg-base-200 hover:bg-base-300/80 transition-all border border-base-300 hover:border-primary/40 hover:shadow-md">
  <div class="card-body p-5">
    <!-- Type badge - subtle, top right -->
    <div class="flex items-start justify-between gap-3">
      <div class="flex-1 min-w-0">
        <!-- Title - larger, more prominent -->
        <h3 class="text-lg font-semibold text-base-content leading-tight line-clamp-2">
          {title}
        </h3>
        <!-- Date - clean and simple -->
        <p class="text-sm text-base-content/50 mt-1.5">
          {formattedDate}
        </p>
      </div>
      <span class="badge badge-sm badge-outline badge-primary/70 shrink-0 font-normal">
        {type}
      </span>
    </div>

    <!-- Summary preview - more breathing room -->
    <p class="text-sm text-base-content/70 line-clamp-2 mt-3 leading-relaxed">
      {previewText}
    </p>

    <!-- Footer - minimal, just vote count if present -->
    {voteCount > 0 && (
      <div class="mt-4 pt-3 border-t border-base-300/50">
        <span class="text-xs text-base-content/50 flex items-center gap-1.5">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
          </svg>
          {voteCount} vote{voteCount !== 1 ? 's' : ''} recorded
        </span>
      </div>
    )}
  </div>
</a>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
